<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Chore::Manager
  
    &mdash; Documentation by YARD 0.9.25
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Chore::Manager";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (M)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Chore.html" title="Chore (module)">Chore</a></span></span>
     &raquo; 
    <span class="title">Manager</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Chore::Manager
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Chore::Manager</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  <dl>
      <dt>Includes:</dt>
      <dd><span class='object_link'><a href="Util.html" title="Chore::Util (module)">Util</a></span></dd>
  </dl>
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/chore/manager.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Manages the interactions between fetching messages (Consumer Strategy), and
working over them (Worker Strategy)</p>


  </div>
</div>
<div class="tags">
  

</div>






  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#assign-instance_method" title="#assign (instance method)">#<strong>assign</strong>(work)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Take in an amount of <code>work</code> (either an Array of, or a single
UnitOfWork), and pass it down for the worker strategy to process.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#fetch_work-instance_method" title="#fetch_work (instance method)">#<strong>fetch_work</strong>(n)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>returns up to n from the throttled consumer queue.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>  &#x21d2; Manager </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A new instance of Manager.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#return_work-instance_method" title="#return_work (instance method)">#<strong>return_work</strong>(work_units)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>gives work back to the fetcher in case it couldn&#39;t be assigned.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#shutdown!-instance_method" title="#shutdown! (instance method)">#<strong>shutdown!</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Shut down the Manager, the Worker Strategy, and the Fetcher.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#start-instance_method" title="#start (instance method)">#<strong>start</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Start the Manager.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Util.html" title="Chore::Util (module)">Util</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Util.html#constantize-instance_method" title="Chore::Util#constantize (method)">#constantize</a></span>, <span class='object_link'><a href="Util.html#procline-instance_method" title="Chore::Util#procline (method)">#procline</a></span></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>  &#x21d2; <tt><span class='object_link'><a href="" title="Chore::Manager (class)">Manager</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a new instance of Manager.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


10
11
12
13
14
15
16
17
18</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/chore/manager.rb', line 10</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="../Chore.html" title="Chore (module)">Chore</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'><span class='object_link'><a href="../Chore.html#logger-class_method" title="Chore.logger (method)">logger</a></span></span><span class='period'>.</span><span class='id identifier rubyid_info'>info</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Booting Chore </span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="../Chore.html" title="Chore (module)">Chore</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Chore.html#VERSION-constant" title="Chore::VERSION (constant)">VERSION</a></span></span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='const'><span class='object_link'><a href="../Chore.html" title="Chore (module)">Chore</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'><span class='object_link'><a href="../Chore.html#logger-class_method" title="Chore.logger (method)">logger</a></span></span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='lbrace'>{</span> <span class='const'><span class='object_link'><a href="../Chore.html" title="Chore (module)">Chore</a></span></span><span class='period'>.</span><span class='id identifier rubyid_config'><span class='object_link'><a href="../Chore.html#config-class_method" title="Chore.config (method)">config</a></span></span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_procline'>procline</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="../Chore.html" title="Chore (module)">Chore</a></span></span><span class='period'>.</span><span class='id identifier rubyid_config'><span class='object_link'><a href="../Chore.html#config-class_method" title="Chore.config (method)">config</a></span></span><span class='period'>.</span><span class='id identifier rubyid_master_procline'>master_procline</span><span class='embexpr_end'>}</span><span class='tstring_content'>:Started:</span><span class='embexpr_beg'>#{</span><span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='ivar'>@started_at</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@worker_strategy</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Chore.html" title="Chore (module)">Chore</a></span></span><span class='period'>.</span><span class='id identifier rubyid_config'><span class='object_link'><a href="../Chore.html#config-class_method" title="Chore.config (method)">config</a></span></span><span class='period'>.</span><span class='id identifier rubyid_worker_strategy'>worker_strategy</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
  <span class='ivar'>@fetcher</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Chore.html" title="Chore (module)">Chore</a></span></span><span class='period'>.</span><span class='id identifier rubyid_config'><span class='object_link'><a href="../Chore.html#config-class_method" title="Chore.config (method)">config</a></span></span><span class='period'>.</span><span class='id identifier rubyid_fetcher'>fetcher</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span>
  <span class='ivar'>@stopping</span> <span class='op'>=</span> <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="assign-instance_method">
  
    #<strong>assign</strong>(work)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Take in an amount of <code>work</code> (either an Array of, or a single
UnitOfWork), and pass it down for the worker strategy to process.
<strong>This method is blocking</strong>. It will continue to attempt to
assign the work via the worker strategy, until it accepts it. It is up to
the strategy to determine what cases it is allowed to accept work. The
blocking semantic of this method is to prevent the Fetcher from getting
messages off of the queue faster than they can be consumed.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


45
46
47
48
49
50
51</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/chore/manager.rb', line 45</span>

<span class='kw'>def</span> <span class='id identifier rubyid_assign'>assign</span><span class='lparen'>(</span><span class='id identifier rubyid_work'>work</span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="../Chore.html" title="Chore (module)">Chore</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'><span class='object_link'><a href="../Chore.html#logger-class_method" title="Chore.logger (method)">logger</a></span></span><span class='period'>.</span><span class='id identifier rubyid_debug'>debug</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Manager#assign: No. of UnitsOfWork: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_work'>work</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span><span class='embexpr_end'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_work'>work</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span> <span class='id identifier rubyid_item'>item</span> <span class='op'>|</span>
    <span class='const'><span class='object_link'><a href="../Chore.html" title="Chore (module)">Chore</a></span></span><span class='period'>.</span><span class='id identifier rubyid_run_hooks_for'><span class='object_link'><a href="../Chore.html#run_hooks_for-class_method" title="Chore.run_hooks_for (method)">run_hooks_for</a></span></span><span class='lparen'>(</span><span class='symbol'>:before_send_to_worker</span><span class='comma'>,</span> <span class='id identifier rubyid_item'>item</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='ivar'>@worker_strategy</span><span class='period'>.</span><span class='id identifier rubyid_assign'>assign</span><span class='lparen'>(</span><span class='id identifier rubyid_work'>work</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='ivar'>@stopping</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="fetch_work-instance_method">
  
    #<strong>fetch_work</strong>(n)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>returns up to n from the throttled consumer queue</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


54
55
56</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/chore/manager.rb', line 54</span>

<span class='kw'>def</span> <span class='id identifier rubyid_fetch_work'>fetch_work</span><span class='lparen'>(</span><span class='id identifier rubyid_n'>n</span><span class='rparen'>)</span>
  <span class='ivar'>@fetcher</span><span class='period'>.</span><span class='id identifier rubyid_provide_work'>provide_work</span><span class='lparen'>(</span><span class='id identifier rubyid_n'>n</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="return_work-instance_method">
  
    #<strong>return_work</strong>(work_units)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>gives work back to the fetcher in case it couldn&#39;t be assigned</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


59
60
61</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/chore/manager.rb', line 59</span>

<span class='kw'>def</span> <span class='id identifier rubyid_return_work'>return_work</span><span class='lparen'>(</span><span class='id identifier rubyid_work_units'>work_units</span><span class='rparen'>)</span>
  <span class='ivar'>@fetcher</span><span class='period'>.</span><span class='id identifier rubyid_return_work'>return_work</span><span class='lparen'>(</span><span class='id identifier rubyid_work_units'>work_units</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="shutdown!-instance_method">
  
    #<strong>shutdown!</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Shut down the Manager, the Worker Strategy, and the Fetcher. This calls the
<code>:before_shutdown</code> hook.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


29
30
31
32
33
34
35
36
37
38</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/chore/manager.rb', line 29</span>

<span class='kw'>def</span> <span class='id identifier rubyid_shutdown!'>shutdown!</span>
  <span class='kw'>unless</span> <span class='ivar'>@stopping</span>
    <span class='const'><span class='object_link'><a href="../Chore.html" title="Chore (module)">Chore</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'><span class='object_link'><a href="../Chore.html#logger-class_method" title="Chore.logger (method)">logger</a></span></span><span class='period'>.</span><span class='id identifier rubyid_info'>info</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Manager shutting down started</span><span class='tstring_end'>&quot;</span></span>
    <span class='ivar'>@stopping</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='const'><span class='object_link'><a href="../Chore.html" title="Chore (module)">Chore</a></span></span><span class='period'>.</span><span class='id identifier rubyid_run_hooks_for'><span class='object_link'><a href="../Chore.html#run_hooks_for-class_method" title="Chore.run_hooks_for (method)">run_hooks_for</a></span></span><span class='lparen'>(</span><span class='symbol'>:before_shutdown</span><span class='rparen'>)</span>
    <span class='ivar'>@fetcher</span><span class='period'>.</span><span class='id identifier rubyid_stop!'>stop!</span>
    <span class='ivar'>@worker_strategy</span><span class='period'>.</span><span class='id identifier rubyid_stop!'>stop!</span>
    <span class='const'><span class='object_link'><a href="../Chore.html" title="Chore (module)">Chore</a></span></span><span class='period'>.</span><span class='id identifier rubyid_logger'><span class='object_link'><a href="../Chore.html#logger-class_method" title="Chore.logger (method)">logger</a></span></span><span class='period'>.</span><span class='id identifier rubyid_info'>info</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Manager shutting down completed</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="start-instance_method">
  
    #<strong>start</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Start the Manager. This calls both the #start method of the configured
Worker Strategy, as well as Fetcher#start.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


21
22
23
24
25
26</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/chore/manager.rb', line 21</span>

<span class='kw'>def</span> <span class='id identifier rubyid_start'>start</span>
  <span class='const'><span class='object_link'><a href="../Chore.html" title="Chore (module)">Chore</a></span></span><span class='period'>.</span><span class='id identifier rubyid_run_hooks_for'><span class='object_link'><a href="../Chore.html#run_hooks_for-class_method" title="Chore.run_hooks_for (method)">run_hooks_for</a></span></span><span class='lparen'>(</span><span class='symbol'>:before_start</span><span class='rparen'>)</span>
  <span class='ivar'>@started_at</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span>
  <span class='ivar'>@worker_strategy</span><span class='period'>.</span><span class='id identifier rubyid_start'>start</span>
  <span class='ivar'>@fetcher</span><span class='period'>.</span><span class='id identifier rubyid_start'>start</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Mon Sep 14 12:30:29 2020 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.25 (ruby-2.3.0).
</div>

    </div>
  </body>
</html>